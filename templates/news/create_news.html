{% extends 'base.html' %}
{% load static %}
{% block title %}
News
{% endblock %}
{% block header %}
    <style>
        .image-upload-preview {
            max-height: 300px;
            object-fit: contain;
            display: none;
        }
        .upload-area {
            transition: all 0.3s ease;
        }
        .upload-area.drag-over {
            background-color: #f0f9ff;
            border-color: #3b82f6;
        }
    </style>
{% endblock %}
{% block content %}
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Back Button -->
        <a href="{% url "news:news_feed" %}" class="flex items-center text-blue-600 hover:text-blue-800 mb-6">
            <i class="fas fa-arrow-left mr-2"></i> Back to News Feed
        </a>
        
        <!-- Create News Form -->
        <article class="bg-white rounded-lg shadow-md overflow-hidden">
            <div class="p-6">
                <!-- Form Header -->
                <header class="mb-6">
                    <h1 class="text-3xl font-bold mb-2">Create New Article</h1>
                    <p class="text-gray-600">Share your news with our community</p>
                </header>

                <!-- Article Form -->
                <form>
                    <!-- Title -->
                    <div class="mb-6">
                        <label for="title" class="block text-gray-700 font-medium mb-2">Article Title*</label>
                        <input type="text" id="title" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter a compelling headline" required>
                    </div>

                    <!-- Category Selection -->
                    <div class="mb-6">
                        <label class="block text-gray-700 font-medium mb-2">Categories*</label>
                        <div class="flex flex-wrap gap-2">
                            <label class="inline-flex items-center">
                                <input type="checkbox" class="form-checkbox text-blue-600" name="categories[]" value="Politics">
                                <span class="ml-2 px-3 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full">Politics</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" class="form-checkbox text-blue-600" name="categories[]" value="Technology">
                                <span class="ml-2 px-3 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full">Technology</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" class="form-checkbox text-blue-600" name="categories[]" value="Business">
                                <span class="ml-2 px-3 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-full">Business</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" class="form-checkbox text-blue-600" name="categories[]" value="Sports">
                                <span class="ml-2 px-3 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full">Sports</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" class="form-checkbox text-blue-600" name="categories[]" value="Health">
                                <span class="ml-2 px-3 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full">Health</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" class="form-checkbox text-blue-600" name="categories[]" value="Science">
                                <span class="ml-2 px-3 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-full">Science</span>
                            </label>
                        </div>
                    </div>

                    <!-- Featured Image -->
                    <div class="mb-6">
                        <label class="block text-gray-700 font-medium mb-2">Featured Image</label>
                        <div id="upload-container" class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center upload-area">
                            <img id="image-preview" class="image-upload-preview w-full mb-4 rounded-lg mx-auto">
                            <div id="upload-area-content">
                                <i class="fas fa-image text-4xl text-blue-500 mb-3"></i>
                                <p class="text-gray-600 mb-1">Drag & drop your image here or click to browse</p>
                                <p class="text-gray-400 text-sm">Supports JPG, PNG (any resolution)</p>
                                <input type="file" id="image-upload" class="hidden" accept="image/*">
                            </div>
                        </div>
                    </div>

                    <!-- Content Editor -->
                    <div class="mb-6">
                        <label for="content" class="block text-gray-700 font-medium mb-2">Article Content*</label>
                        <textarea id="content" rows="12" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Write your article here..." required></textarea>
                    </div>

                    <!-- Author Info -->
                    <div class="mb-8">
                        <label for="author" class="block text-gray-700 font-medium mb-2">Author Name*</label>
                        <input type="text" id="author" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Your name" required>
                    </div>

                    <!-- Submit Button -->
                    <div class="flex justify-between items-center">
                        <div class="text-sm text-gray-500">
                            <i class="fas fa-info-circle mr-1"></i> Fields marked with * are required
                        </div>
                        <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center">
                            <i class="fas fa-paper-plane mr-2"></i> Publish Article
                        </button>
                    </div>
                </form>
            </div>
        </article>
    </div>

    <script>
        // Image upload functionality
        const imageUpload = document.getElementById('image-upload');
        const imagePreview = document.getElementById('image-preview');
        const uploadContainer = document.getElementById('upload-container');
        const uploadAreaContent = document.getElementById('upload-area-content');

        // Click to upload
        uploadContainer.addEventListener('click', () => {
            imageUpload.click();
        });

        // Handle file selection
        imageUpload.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                displayImagePreview(file);
            }
        });

        // Drag and drop functionality
        uploadContainer.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadContainer.classList.add('drag-over');
        });

        ['dragleave', 'dragend'].forEach(type => {
            uploadContainer.addEventListener(type, () => {
                uploadContainer.classList.remove('drag-over');
            });
        });

        uploadContainer.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadContainer.classList.remove('drag-over');
            
            const file = e.dataTransfer.files[0];
            if (file && file.type.match('image.*')) {
                displayImagePreview(file);
                imageUpload.files = e.dataTransfer.files;
            }
        });

        function displayImagePreview(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                imagePreview.src = e.target.result;
                imagePreview.style.display = 'block';
                uploadAreaContent.style.display = 'none';
            };
            reader.readAsDataURL(file);
        }

        // Reset button (optional)
        function resetImageUpload() {
            imagePreview.src = '';
            imagePreview.style.display = 'none';
            uploadAreaContent.style.display = 'block';
            imageUpload.value = '';
        }
    </script>
{% endblock %}